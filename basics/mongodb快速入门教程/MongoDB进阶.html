<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3.MongoDB进阶 | 螺钉前端</title>
    <meta name="description" content="帮助零基础同学转行，入职前端开发，薪资5000-12000">
    <link rel="icon" href="/logo.png">
  <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e2bd54b8015cec977c6f30d0896b8a1b";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
      </script>
    
    <link rel="preload" href="/assets/css/0.styles.830e21dc.css" as="style"><link rel="preload" href="/assets/js/app.4c3c285e.js" as="script"><link rel="preload" href="/assets/js/2.35988976.js" as="script"><link rel="preload" href="/assets/js/16.ba17c819.js" as="script"><link rel="prefetch" href="/assets/js/10.0809a72a.js"><link rel="prefetch" href="/assets/js/100.d8310b4b.js"><link rel="prefetch" href="/assets/js/101.503f02c3.js"><link rel="prefetch" href="/assets/js/102.5d351a2d.js"><link rel="prefetch" href="/assets/js/103.c6129a47.js"><link rel="prefetch" href="/assets/js/104.5ded5ac5.js"><link rel="prefetch" href="/assets/js/105.589fa0d4.js"><link rel="prefetch" href="/assets/js/106.a5d3f2d9.js"><link rel="prefetch" href="/assets/js/107.651f67d2.js"><link rel="prefetch" href="/assets/js/108.d0d9b2ce.js"><link rel="prefetch" href="/assets/js/109.1a94580a.js"><link rel="prefetch" href="/assets/js/11.117e5df8.js"><link rel="prefetch" href="/assets/js/110.5d026414.js"><link rel="prefetch" href="/assets/js/111.b9698895.js"><link rel="prefetch" href="/assets/js/112.2f1eee19.js"><link rel="prefetch" href="/assets/js/113.ab1cc016.js"><link rel="prefetch" href="/assets/js/114.bb666e12.js"><link rel="prefetch" href="/assets/js/115.792d9fcc.js"><link rel="prefetch" href="/assets/js/116.6c4b9e1a.js"><link rel="prefetch" href="/assets/js/117.0f22d149.js"><link rel="prefetch" href="/assets/js/118.e0cdb666.js"><link rel="prefetch" href="/assets/js/119.53a0c74f.js"><link rel="prefetch" href="/assets/js/12.44c347ff.js"><link rel="prefetch" href="/assets/js/120.d3bda3aa.js"><link rel="prefetch" href="/assets/js/121.2eac6dcb.js"><link rel="prefetch" href="/assets/js/122.0c22ef17.js"><link rel="prefetch" href="/assets/js/123.fb674a1e.js"><link rel="prefetch" href="/assets/js/124.c1957c66.js"><link rel="prefetch" href="/assets/js/125.82296d79.js"><link rel="prefetch" href="/assets/js/126.cad2ebcc.js"><link rel="prefetch" href="/assets/js/127.536fc158.js"><link rel="prefetch" href="/assets/js/128.f38a8121.js"><link rel="prefetch" href="/assets/js/129.835af9eb.js"><link rel="prefetch" href="/assets/js/13.0990c880.js"><link rel="prefetch" href="/assets/js/130.0e32ffff.js"><link rel="prefetch" href="/assets/js/131.06dc20fa.js"><link rel="prefetch" href="/assets/js/132.b3af08ce.js"><link rel="prefetch" href="/assets/js/133.d0d4d25d.js"><link rel="prefetch" href="/assets/js/134.7c659774.js"><link rel="prefetch" href="/assets/js/135.91d30218.js"><link rel="prefetch" href="/assets/js/136.705e71a1.js"><link rel="prefetch" href="/assets/js/137.67ac551a.js"><link rel="prefetch" href="/assets/js/138.e1f063e6.js"><link rel="prefetch" href="/assets/js/139.c64481f7.js"><link rel="prefetch" href="/assets/js/14.4d578419.js"><link rel="prefetch" href="/assets/js/140.b3a94175.js"><link rel="prefetch" href="/assets/js/141.b1881667.js"><link rel="prefetch" href="/assets/js/142.f60ac7ca.js"><link rel="prefetch" href="/assets/js/143.d2bf8c2b.js"><link rel="prefetch" href="/assets/js/144.28d0a4f2.js"><link rel="prefetch" href="/assets/js/145.2520fa3a.js"><link rel="prefetch" href="/assets/js/146.74de499d.js"><link rel="prefetch" href="/assets/js/147.f9128127.js"><link rel="prefetch" href="/assets/js/148.af3b2732.js"><link rel="prefetch" href="/assets/js/149.d82805ec.js"><link rel="prefetch" href="/assets/js/15.0aec8b55.js"><link rel="prefetch" href="/assets/js/150.25aeea37.js"><link rel="prefetch" href="/assets/js/151.abd7ef02.js"><link rel="prefetch" href="/assets/js/152.9144e36e.js"><link rel="prefetch" href="/assets/js/153.e161c356.js"><link rel="prefetch" href="/assets/js/154.d1f428f9.js"><link rel="prefetch" href="/assets/js/155.cfb64163.js"><link rel="prefetch" href="/assets/js/156.c1d7efea.js"><link rel="prefetch" href="/assets/js/157.7cc86938.js"><link rel="prefetch" href="/assets/js/158.0bbdbb57.js"><link rel="prefetch" href="/assets/js/159.6fb40b2e.js"><link rel="prefetch" href="/assets/js/160.a2704844.js"><link rel="prefetch" href="/assets/js/161.129a8d66.js"><link rel="prefetch" href="/assets/js/162.9fcbc103.js"><link rel="prefetch" href="/assets/js/163.bc8b2720.js"><link rel="prefetch" href="/assets/js/164.23718563.js"><link rel="prefetch" href="/assets/js/165.3832b2fb.js"><link rel="prefetch" href="/assets/js/166.50cdb4b6.js"><link rel="prefetch" href="/assets/js/167.3894de9c.js"><link rel="prefetch" href="/assets/js/168.31c105f6.js"><link rel="prefetch" href="/assets/js/169.ce5b3623.js"><link rel="prefetch" href="/assets/js/17.82672299.js"><link rel="prefetch" href="/assets/js/170.c1c272d8.js"><link rel="prefetch" href="/assets/js/171.28ae28fd.js"><link rel="prefetch" href="/assets/js/172.e88b63ba.js"><link rel="prefetch" href="/assets/js/173.d80be42c.js"><link rel="prefetch" href="/assets/js/174.c93d8ee6.js"><link rel="prefetch" href="/assets/js/175.5ad5c54a.js"><link rel="prefetch" href="/assets/js/176.9be9b361.js"><link rel="prefetch" href="/assets/js/177.1da98845.js"><link rel="prefetch" href="/assets/js/178.050b5a93.js"><link rel="prefetch" href="/assets/js/179.44f7d1b5.js"><link rel="prefetch" href="/assets/js/18.b20be58c.js"><link rel="prefetch" href="/assets/js/180.b5d4db3c.js"><link rel="prefetch" href="/assets/js/181.4a2a0ca9.js"><link rel="prefetch" href="/assets/js/182.07a102f3.js"><link rel="prefetch" href="/assets/js/183.cdcf0c40.js"><link rel="prefetch" href="/assets/js/184.4f78232c.js"><link rel="prefetch" href="/assets/js/185.f51bec5f.js"><link rel="prefetch" href="/assets/js/186.029f1d35.js"><link rel="prefetch" href="/assets/js/187.f255a676.js"><link rel="prefetch" href="/assets/js/188.de182007.js"><link rel="prefetch" href="/assets/js/189.10b972f3.js"><link rel="prefetch" href="/assets/js/19.b7271ed6.js"><link rel="prefetch" href="/assets/js/190.5fd9343d.js"><link rel="prefetch" href="/assets/js/191.f5152b31.js"><link rel="prefetch" href="/assets/js/192.66d7fa13.js"><link rel="prefetch" href="/assets/js/193.fdeaeda4.js"><link rel="prefetch" href="/assets/js/194.ad25ba5e.js"><link rel="prefetch" href="/assets/js/195.03913adc.js"><link rel="prefetch" href="/assets/js/196.d2ce6bf5.js"><link rel="prefetch" href="/assets/js/197.34acf369.js"><link rel="prefetch" href="/assets/js/198.a329ed4e.js"><link rel="prefetch" href="/assets/js/199.114b5c2b.js"><link rel="prefetch" href="/assets/js/20.ec886eea.js"><link rel="prefetch" href="/assets/js/200.91f58af4.js"><link rel="prefetch" href="/assets/js/201.8607f87f.js"><link rel="prefetch" href="/assets/js/202.1d1b5024.js"><link rel="prefetch" href="/assets/js/203.6332d6aa.js"><link rel="prefetch" href="/assets/js/204.144f7ce3.js"><link rel="prefetch" href="/assets/js/205.16a39432.js"><link rel="prefetch" href="/assets/js/206.6eac6d07.js"><link rel="prefetch" href="/assets/js/207.befb0534.js"><link rel="prefetch" href="/assets/js/208.82b906c6.js"><link rel="prefetch" href="/assets/js/209.8c8cce8f.js"><link rel="prefetch" href="/assets/js/21.f2a3e37a.js"><link rel="prefetch" href="/assets/js/210.6c38f127.js"><link rel="prefetch" href="/assets/js/211.3e7e3332.js"><link rel="prefetch" href="/assets/js/212.a9bc62eb.js"><link rel="prefetch" href="/assets/js/213.b5bce6ee.js"><link rel="prefetch" href="/assets/js/214.7a7e0c32.js"><link rel="prefetch" href="/assets/js/215.3363643e.js"><link rel="prefetch" href="/assets/js/216.576d4291.js"><link rel="prefetch" href="/assets/js/217.9b02761b.js"><link rel="prefetch" href="/assets/js/218.2c8d5026.js"><link rel="prefetch" href="/assets/js/219.0a093045.js"><link rel="prefetch" href="/assets/js/22.468bb897.js"><link rel="prefetch" href="/assets/js/220.25759ab0.js"><link rel="prefetch" href="/assets/js/221.45332d2d.js"><link rel="prefetch" href="/assets/js/222.d25f0cfa.js"><link rel="prefetch" href="/assets/js/223.0bfa2457.js"><link rel="prefetch" href="/assets/js/224.70b2953f.js"><link rel="prefetch" href="/assets/js/225.46da8954.js"><link rel="prefetch" href="/assets/js/226.097d15f7.js"><link rel="prefetch" href="/assets/js/227.10b91bea.js"><link rel="prefetch" href="/assets/js/228.5d586eb3.js"><link rel="prefetch" href="/assets/js/229.2a60964a.js"><link rel="prefetch" href="/assets/js/23.2b2fa42d.js"><link rel="prefetch" href="/assets/js/230.abcbb8ee.js"><link rel="prefetch" href="/assets/js/231.a314da07.js"><link rel="prefetch" href="/assets/js/232.64676258.js"><link rel="prefetch" href="/assets/js/233.9c86ded1.js"><link rel="prefetch" href="/assets/js/234.a18f20a6.js"><link rel="prefetch" href="/assets/js/235.3c6f087c.js"><link rel="prefetch" href="/assets/js/236.26e894d3.js"><link rel="prefetch" href="/assets/js/237.46d1f99f.js"><link rel="prefetch" href="/assets/js/238.46026479.js"><link rel="prefetch" href="/assets/js/239.ff830552.js"><link rel="prefetch" href="/assets/js/24.da8569e4.js"><link rel="prefetch" href="/assets/js/240.7ce2fbe0.js"><link rel="prefetch" href="/assets/js/241.7f63fcc0.js"><link rel="prefetch" href="/assets/js/242.8295f0de.js"><link rel="prefetch" href="/assets/js/243.f183b175.js"><link rel="prefetch" href="/assets/js/244.acc3278b.js"><link rel="prefetch" href="/assets/js/245.7ef73821.js"><link rel="prefetch" href="/assets/js/246.7ade592d.js"><link rel="prefetch" href="/assets/js/247.b6bdbc9e.js"><link rel="prefetch" href="/assets/js/248.397d3ae7.js"><link rel="prefetch" href="/assets/js/249.98b89913.js"><link rel="prefetch" href="/assets/js/25.44327d9b.js"><link rel="prefetch" href="/assets/js/250.108c519b.js"><link rel="prefetch" href="/assets/js/251.df25c95b.js"><link rel="prefetch" href="/assets/js/252.44d67967.js"><link rel="prefetch" href="/assets/js/253.c8c169a0.js"><link rel="prefetch" href="/assets/js/254.c6d1d240.js"><link rel="prefetch" href="/assets/js/255.3e875698.js"><link rel="prefetch" href="/assets/js/256.9608b951.js"><link rel="prefetch" href="/assets/js/257.5154d8b3.js"><link rel="prefetch" href="/assets/js/258.68c0084a.js"><link rel="prefetch" href="/assets/js/259.1e17eb83.js"><link rel="prefetch" href="/assets/js/26.8e3a2fdc.js"><link rel="prefetch" href="/assets/js/260.2bfb1254.js"><link rel="prefetch" href="/assets/js/261.305c4aba.js"><link rel="prefetch" href="/assets/js/262.f4e95dbe.js"><link rel="prefetch" href="/assets/js/263.958e0e0d.js"><link rel="prefetch" href="/assets/js/264.7baca583.js"><link rel="prefetch" href="/assets/js/265.cf5ee4ac.js"><link rel="prefetch" href="/assets/js/266.1c987332.js"><link rel="prefetch" href="/assets/js/267.10bf52cc.js"><link rel="prefetch" href="/assets/js/268.3b20da52.js"><link rel="prefetch" href="/assets/js/269.838c4103.js"><link rel="prefetch" href="/assets/js/27.01e54737.js"><link rel="prefetch" href="/assets/js/270.90dc1d21.js"><link rel="prefetch" href="/assets/js/271.293bf47a.js"><link rel="prefetch" href="/assets/js/272.ad955cce.js"><link rel="prefetch" href="/assets/js/273.20689a28.js"><link rel="prefetch" href="/assets/js/274.f1680a80.js"><link rel="prefetch" href="/assets/js/275.3aac1e18.js"><link rel="prefetch" href="/assets/js/276.4341cdcb.js"><link rel="prefetch" href="/assets/js/277.c1646afd.js"><link rel="prefetch" href="/assets/js/278.ffda642b.js"><link rel="prefetch" href="/assets/js/279.0712cfd5.js"><link rel="prefetch" href="/assets/js/28.4a3312b8.js"><link rel="prefetch" href="/assets/js/280.d0a9e837.js"><link rel="prefetch" href="/assets/js/281.7f94b988.js"><link rel="prefetch" href="/assets/js/29.7deca706.js"><link rel="prefetch" href="/assets/js/3.619aa9ab.js"><link rel="prefetch" href="/assets/js/30.bbe18c23.js"><link rel="prefetch" href="/assets/js/31.d9858940.js"><link rel="prefetch" href="/assets/js/32.b5337a99.js"><link rel="prefetch" href="/assets/js/33.743e0245.js"><link rel="prefetch" href="/assets/js/34.045bd74e.js"><link rel="prefetch" href="/assets/js/35.79ff5def.js"><link rel="prefetch" href="/assets/js/36.1a1400b4.js"><link rel="prefetch" href="/assets/js/37.66b0b9cc.js"><link rel="prefetch" href="/assets/js/38.1cbbe2a9.js"><link rel="prefetch" href="/assets/js/39.4b7cc766.js"><link rel="prefetch" href="/assets/js/4.72e92390.js"><link rel="prefetch" href="/assets/js/40.5e06f5bf.js"><link rel="prefetch" href="/assets/js/41.4e4631a8.js"><link rel="prefetch" href="/assets/js/42.880981c4.js"><link rel="prefetch" href="/assets/js/43.178e9db3.js"><link rel="prefetch" href="/assets/js/44.cb911db2.js"><link rel="prefetch" href="/assets/js/45.f46a1807.js"><link rel="prefetch" href="/assets/js/46.72d2caae.js"><link rel="prefetch" href="/assets/js/47.ec98d891.js"><link rel="prefetch" href="/assets/js/48.3e48a260.js"><link rel="prefetch" href="/assets/js/49.5b4acb74.js"><link rel="prefetch" href="/assets/js/5.60e38b16.js"><link rel="prefetch" href="/assets/js/50.87ebcffd.js"><link rel="prefetch" href="/assets/js/51.d0c481a1.js"><link rel="prefetch" href="/assets/js/52.ceeea1f7.js"><link rel="prefetch" href="/assets/js/53.aa7484c2.js"><link rel="prefetch" href="/assets/js/54.852fbdeb.js"><link rel="prefetch" href="/assets/js/55.71eed07f.js"><link rel="prefetch" href="/assets/js/56.d7b4184a.js"><link rel="prefetch" href="/assets/js/57.b855843f.js"><link rel="prefetch" href="/assets/js/58.99ea811e.js"><link rel="prefetch" href="/assets/js/59.c35d6ca0.js"><link rel="prefetch" href="/assets/js/6.e2a5f4eb.js"><link rel="prefetch" href="/assets/js/60.faa94541.js"><link rel="prefetch" href="/assets/js/61.201bd301.js"><link rel="prefetch" href="/assets/js/62.6b322f48.js"><link rel="prefetch" href="/assets/js/63.1d9e0c71.js"><link rel="prefetch" href="/assets/js/64.8da9224b.js"><link rel="prefetch" href="/assets/js/65.3b6af424.js"><link rel="prefetch" href="/assets/js/66.587fc6bc.js"><link rel="prefetch" href="/assets/js/67.29f1149e.js"><link rel="prefetch" href="/assets/js/68.c4b9a60c.js"><link rel="prefetch" href="/assets/js/69.32aee3ee.js"><link rel="prefetch" href="/assets/js/7.016407d6.js"><link rel="prefetch" href="/assets/js/70.9a8a0683.js"><link rel="prefetch" href="/assets/js/71.b8e3cdc6.js"><link rel="prefetch" href="/assets/js/72.f0fc170f.js"><link rel="prefetch" href="/assets/js/73.7d91c309.js"><link rel="prefetch" href="/assets/js/74.b5f0255a.js"><link rel="prefetch" href="/assets/js/75.e86f9491.js"><link rel="prefetch" href="/assets/js/76.033a8716.js"><link rel="prefetch" href="/assets/js/77.a4e3262b.js"><link rel="prefetch" href="/assets/js/78.e2ea8d44.js"><link rel="prefetch" href="/assets/js/79.72045e29.js"><link rel="prefetch" href="/assets/js/8.4428ceee.js"><link rel="prefetch" href="/assets/js/80.2dfbf868.js"><link rel="prefetch" href="/assets/js/81.a35fea2c.js"><link rel="prefetch" href="/assets/js/82.cac44de7.js"><link rel="prefetch" href="/assets/js/83.b1e15f71.js"><link rel="prefetch" href="/assets/js/84.744feca7.js"><link rel="prefetch" href="/assets/js/85.d4398600.js"><link rel="prefetch" href="/assets/js/86.2ff5fc32.js"><link rel="prefetch" href="/assets/js/87.2b2547de.js"><link rel="prefetch" href="/assets/js/88.8807bdd7.js"><link rel="prefetch" href="/assets/js/89.bf869c9a.js"><link rel="prefetch" href="/assets/js/9.f56957fc.js"><link rel="prefetch" href="/assets/js/90.4105c2f5.js"><link rel="prefetch" href="/assets/js/91.24a33f7f.js"><link rel="prefetch" href="/assets/js/92.8d7dbaad.js"><link rel="prefetch" href="/assets/js/93.9e6fd924.js"><link rel="prefetch" href="/assets/js/94.9381c401.js"><link rel="prefetch" href="/assets/js/95.eaa1808d.js"><link rel="prefetch" href="/assets/js/96.e3a8d59f.js"><link rel="prefetch" href="/assets/js/97.a6375129.js"><link rel="prefetch" href="/assets/js/98.ad841694.js"><link rel="prefetch" href="/assets/js/99.3a6761fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.830e21dc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">螺钉前端</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/basics/" class="nav-link router-link-active">基础教程</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目实战</a></div><div class="nav-item"><a href="/article/" class="nav-link">零散文章</a></div><div class="nav-item"><a href="/association/" class="nav-link">一起学习</a></div><div class="nav-item"><a href="/architect/" class="nav-link">前端架构师</a></div><div class="nav-item"><a href="/article/螺钉课堂产品矩阵/" class="nav-link">螺钉课堂产品矩阵</a></div><div class="nav-item"><a href="https://edu.nodeing.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/basics/" class="nav-link router-link-active">基础教程</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目实战</a></div><div class="nav-item"><a href="/article/" class="nav-link">零散文章</a></div><div class="nav-item"><a href="/association/" class="nav-link">一起学习</a></div><div class="nav-item"><a href="/architect/" class="nav-link">前端架构师</a></div><div class="nav-item"><a href="/article/螺钉课堂产品矩阵/" class="nav-link">螺钉课堂产品矩阵</a></div><div class="nav-item"><a href="https://edu.nodeing.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/basics/mongodb%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="sidebar-link">MongoDB快速入门教程</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB初识.html" class="sidebar-link">1.MongoDB初识</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB的基本的CRUD操作.html" class="sidebar-link">2.MongoDB的基本的CRUD操作</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB进阶.html" class="active sidebar-link">3.MongoDB进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/MongoDB进阶.html#_3-1-权限验证" class="sidebar-link">3.1.权限验证</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/MongoDB进阶.html#_3-2-索引" class="sidebar-link">3.2.索引</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/MongoDB进阶.html#_3-3-关系型数据库中表的关系" class="sidebar-link">3.3.关系型数据库中表的关系</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/MongoDB进阶.html#_3-4-聚合" class="sidebar-link">3.4.聚合</a></li></ul></li><li><a href="/basics/mongodb快速入门教程/Mongoose使用.html" class="sidebar-link">4.Mongoose使用</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_3-mongodb进阶"><a href="#_3-mongodb进阶" aria-hidden="true" class="header-anchor">#</a> 3.MongoDB进阶</h1> <h2 id="_3-1-权限验证"><a href="#_3-1-权限验证" aria-hidden="true" class="header-anchor">#</a> 3.1.权限验证</h2> <p>以下内容适用于Mac系统用户，window系统用户请看后面文档</p> <h3 id="_3-1-1-创建超级管理员用户"><a href="#_3-1-1-创建超级管理员用户" aria-hidden="true" class="header-anchor">#</a> 3.1.1.创建超级管理员用户</h3> <p>默认情况下连接mongodb是不需要用户名和密码的，这样不安全，我们需要进行安全配置，让连接数据库的时候经过认证才能连接</p> <p>具体配置步骤如下：</p> <p>1.修改mongodb配置文件,开启安全验证</p> <p>如果是brew安装的mongodb，mac系统下地址mongodb默认配置文件 /usr/local/etc/mongod.conf，你需要将你的配置文件写成这样：</p> <div class="language- extra-class"><pre class="language-text"><code>systemLog:
  #日志为文件
  destination: file
  #日志存放路径
  path: /data/mongodb/log/mongo.log
  logAppend: true
# 数据库存放路径
storage:
  dbPath: /data/mongodb/db/
net:
  bindIp: 127.0.0.1
#进程
processManagement:
# 守护进程方式
  fork: true
# 开启权限验证
security:
  authorization: enabled
</code></pre></div><p>上面配置文件中，日志存放路径和数据库存放路径需要存在，也就是说你需要先去把这些文件夹创建好，并且给上读写权限</p> <p>2.重启mongodb服务</p> <div class="language- extra-class"><pre class="language-text"><code>sudo mongod --config /usr/local/etc/mongod.conf
</code></pre></div><p>重启服务的时候是需要带上配置文件的，这样才能让你的配置生效，需要注意的是，在配置文件中，我们设置了守护进程的方式（fork: true），这种方式允许服务在后台运行</p> <p>3.创建超级管理员用户名</p> <p>首先，运行连接mongodb</p> <div class="language-js extra-class"><pre class="language-js"><code>mongo
</code></pre></div><p>接着，选中数据库</p> <div class="language-js extra-class"><pre class="language-js"><code>use admin
</code></pre></div><p>开始创建用户名</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
user<span class="token punctuation">:</span><span class="token string">'admin'</span><span class="token punctuation">,</span>
pwd<span class="token punctuation">:</span><span class="token string">'123456'</span><span class="token punctuation">,</span> roles<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>role<span class="token punctuation">:</span><span class="token string">'root'</span><span class="token punctuation">,</span>db<span class="token punctuation">:</span><span class="token string">'admin'</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>验证用户名和密码</p> <div class="language- extra-class"><pre class="language-text"><code>db.auth(&quot;admin&quot;, &quot;123456&quot;)
</code></pre></div><p>上面命令如果返回1 表示验证成功， 0 表示验证失败</p> <p>如果验证成功，即可正常使用了</p> <div class="language- extra-class"><pre class="language-text"><code>show dbs
</code></pre></div><p>除了上面通过db.auth来验证超级管理员权限以外，还可以在连接的时候，直接给用户名和密码</p> <div class="language- extra-class"><pre class="language-text"><code>mongo admin -u admin -p 123456
</code></pre></div><h3 id="_3-1-2-创建普通用户"><a href="#_3-1-2-创建普通用户" aria-hidden="true" class="header-anchor">#</a> 3.1.2.创建普通用户</h3> <p>普通用户就是某个数据库的用户，这个用户只有某个数据库的权限</p> <p>要创建普通用户，你必须具有超级管理员的权限，因此，得先以超级管理员登录进去</p> <div class="language-js extra-class"><pre class="language-js"><code>mongo admin <span class="token operator">-</span>u admin <span class="token operator">-</span>p <span class="token number">123456</span>
</code></pre></div><p>接下来，选中你要设置权限的数据库</p> <div class="language-js extra-class"><pre class="language-js"><code> use nodeing_cms
</code></pre></div><p>创建普通用户</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>user<span class="token punctuation">:</span> <span class="token string">&quot;nodeing_cms_user&quot;</span><span class="token punctuation">,</span> pwd<span class="token punctuation">:</span> <span class="token string">&quot;nodeing123&quot;</span><span class="token punctuation">,</span> roles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> role<span class="token punctuation">:</span> <span class="token string">&quot;dbOwner&quot;</span><span class="token punctuation">,</span> db<span class="token punctuation">:</span> <span class="token string">&quot;nodeing_cms&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-1-3-windows用户权限验证设置"><a href="#_3-1-3-windows用户权限验证设置" aria-hidden="true" class="header-anchor">#</a> 3.1.3.windows用户权限验证设置</h4> <p>1.连接mongodb数据库</p> <div class="language- extra-class"><pre class="language-text"><code>mongo
</code></pre></div><p>2.设置管理员密码</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">createUSer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
  pwd<span class="token punctuation">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
  roles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>role<span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> db<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>3.修改配置文件，开启权限验证</p> <p>配置文件位置：在你安装目录下面找，例如我的安装目录在c盘，具体位置如下： C:\Program Files\MongoDB\Server\4.0\bin\mongod.cfg</p> <div class="language-js extra-class"><pre class="language-js"><code>security<span class="token punctuation">:</span>
  authorization<span class="token punctuation">:</span> enabled
</code></pre></div><p>4.重启服务</p> <p><img src="/assets/img/2019-06-09-09-15-23.27bdfc1f.png" alt=""></p> <p>5.连接服务器</p> <div class="language- extra-class"><pre class="language-text"><code>mongo admin -u admin -p 123456
</code></pre></div><h2 id="_3-2-索引"><a href="#_3-2-索引" aria-hidden="true" class="header-anchor">#</a> 3.2.索引</h2> <p>索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，建立索引，通常能够极大的提高查询的效率，如果没有索引，MongoDB在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录，这种扫描全集合的查询效率是非常低的，特别是在数据量特别大的时候，话费的时间就非常的多</p> <p>举个例子：目前我的一个集合中有170多万条数据，我们在没有建立索引的情况下测试一下查询时间</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>course<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;mongodb入门8888&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">explain</span><span class="token punctuation">(</span><span class="token string">&quot;executionStats&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>执行时间：</p> <p><img src="/assets/img/2019-04-24-14-28-11.8803e4e3.png" alt=""></p> <p>接下来，我们创建索引：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//语法： db.集合名称.createIndex({})</span>
db<span class="token punctuation">.</span>course<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>createIndex方法中，name表示查询的字段，1表示升序，-1表示降序</p> <p>创建好索引后，我们再次执行查询</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>course<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;mongodb入门8888&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">explain</span><span class="token punctuation">(</span><span class="token string">&quot;executionStats&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>以下是执行时间：</p> <p><img src="/assets/img/2019-04-24-14-42-52.adbaee1d.png" alt=""></p> <h2 id="_3-3-关系型数据库中表的关系"><a href="#_3-3-关系型数据库中表的关系" aria-hidden="true" class="header-anchor">#</a> 3.3.关系型数据库中表的关系</h2> <h3 id="_3-3-1-一对一关系"><a href="#_3-3-1-一对一关系" aria-hidden="true" class="header-anchor">#</a> 3.3.1.一对一关系</h3> <p>一对一的关系比较简单，例如：一个人只有一张身份证，一张身份证只对应一个人</p> <p>数据库中表关系举例：</p> <p><img src="/assets/img/2019-05-05-08-24-24.c9255e81.png" alt=""></p> <p>一张user表对应一张driver表，意味着我们可以通过user表中的uid去查询driver表中和这个uid相同的这个人的驾驶证信息</p> <h3 id="_3-3-2-一对多关系"><a href="#_3-3-2-一对多关系" aria-hidden="true" class="header-anchor">#</a> 3.3.2.一对多关系</h3> <p>一对多的关系简单的说就是一个对应多个，例如：一个母亲可以有多个儿女，但是每个儿女只对应着一个亲生母亲</p> <p>数据库中表关系举例：</p> <p><img src="/assets/img/2019-05-05-08-39-46.f9e3d48f.png" alt=""></p> <p>在上面这种应用场景中，一张category表和goods表关联，关系为一对多关系，一个分类下面有多种商品，一种商品只放入一个分类，我们可以根据category中的分类id去goods表中查询出当前分类下到底有多少商品，同时也可以用goods表中的cate_id来查询出当前分类的一些信息</p> <h3 id="_3-3-3-多对多关系"><a href="#_3-3-3-多对多关系" aria-hidden="true" class="header-anchor">#</a> 3.3.3.多对多关系</h3> <p>多对多关系举例：一个学生可以选择多门课程学习，例如，语文、数学、计算机，同时一门课程也可以有多个学生来学习，例如，数学课程有50人学习，英语课程有100人学习等</p> <p>数据库中表关系举例：</p> <p><img src="/assets/img/2019-05-05-08-52-06.b9756a7a.png" alt=""></p> <p>多对多关系在数据库中通常需要第三张表来存储对应关系，上面的图中，我们使用student_course来存储关系，在这张表中，sid和cid分别是学生表中的id和课程表中的id，当我们想知道一个学生选择了多少门课程的时候，我们只需要在student_course表中，根据sid来查询出对应的cid就可以了</p> <h2 id="_3-4-聚合"><a href="#_3-4-聚合" aria-hidden="true" class="header-anchor">#</a> 3.4.聚合</h2> <h3 id="_3-4-1-什么是聚合？"><a href="#_3-4-1-什么是聚合？" aria-hidden="true" class="header-anchor">#</a> 3.4.1.什么是聚合？</h3> <p>MongoDB中聚合(aggregate)主要用于处理数据(诸如统计平均值,求和等)，并返回计算后的数据结果。有点类似sql语句中的 count(*)</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>例如上图中一个集合中有9个文档，通过count操作后，输出一个9，这种操作就是一个单一的聚合操作</p> <h3 id="_3-4-2-什么是聚合管道？"><a href="#_3-4-2-什么是聚合管道？" aria-hidden="true" class="header-anchor">#</a> 3.4.2.什么是聚合管道？</h3> <p>上面说到了单一的聚合操作，那什么又是聚合管道呢？你可以把管道理解为流水线，或者就是水管，把数据看作是水流，我们称之为数据流，管道中装的都是数据，数据在管道中流动，数据在一个管道中经过处理后可以传递到下一个管道，最终得到你想要的数据</p> <p>请看官网例子：</p> <p><img src="/assets/img/2019-05-09-04-49-06.d9bca915.png" alt=""></p> <p>在集合中有4条文档数据，经过$match操作后可以匹配出status为A的数据，此时处理后的数据只剩3条，status为D的这条数据被过滤掉了，紧接着，数据进入下一个管道，此时交给$group来处理，$group的作用是对文档进行分组，分组后又根据amount字段求和，所以id为A123的最终结果是750（500+250）</p> <h3 id="_3-4-3-如何使用聚合管道操作"><a href="#_3-4-3-如何使用聚合管道操作" aria-hidden="true" class="header-anchor">#</a> 3.4.3.如何使用聚合管道操作</h3> <h4 id="_1-aggregate-方法"><a href="#_1-aggregate-方法" aria-hidden="true" class="header-anchor">#</a> 1.aggregate() 方法</h4> <p>这个方法就是用来具体执行管道操作的，具体语法如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token constant">COLLECTION_NAME</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token constant">AGGREGATE_OPERATION</span><span class="token punctuation">)</span>  
</code></pre></div><p>官网例子：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>$match<span class="token punctuation">:</span> <span class="token punctuation">{</span>status<span class="token punctuation">:</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>$group<span class="token punctuation">:</span> <span class="token punctuation">{</span>_id<span class="token punctuation">:</span> <span class="token string">&quot;$cust_id&quot;</span><span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token punctuation">{</span>$sum<span class="token punctuation">:</span> <span class="token string">&quot;$amount&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>aggregate方法中传入一个数组，这个数据中的每个元素就是一次聚合操作，第一个元素的操作执行完后会传递给下个元素执行，每个元素都是一个对象，对象中的key就是管道操作符，例如：{$match: {status: &quot;A&quot;}},这里面的$match就是管道操作符，对象中的value值就是管道表达式,例如：{$match: {status: &quot;A&quot;}},这里面的{status: &quot;A&quot;}就是管道表达式</p> <h4 id="_2-常用管道操作符"><a href="#_2-常用管道操作符" aria-hidden="true" class="header-anchor">#</a> 2.常用管道操作符</h4> <table><thead><tr><th>管道操作符</th> <th>功能描述</th></tr></thead> <tbody><tr><td>$project</td> <td>修改输入文档的结构。可以用来重命名、增加或删除域，也可以用于创建计算结果以及嵌套文档</td></tr> <tr><td>$match</td> <td>用于过滤数据，只输出符合条件的文档</td></tr> <tr><td>$limit</td> <td>用来限制MongoDB聚合管道返回的文档数</td></tr> <tr><td>$skip</td> <td>在聚合管道中跳过指定数量的文档，并返回余下的文档</td></tr> <tr><td>$sort</td> <td>条件排序</td></tr> <tr><td>$group</td> <td>将集合中的文档分组，可用于统计结果</td></tr> <tr><td>$lookup</td> <td>用以引入其他集合的数据,可以用来做关联查询</td></tr></tbody></table> <h4 id="_3-管道表达式"><a href="#_3-管道表达式" aria-hidden="true" class="header-anchor">#</a> 3.管道表达式</h4> <p>前面我们已经说过什么是管道表达式，例如：{_id: &quot;$cust_id&quot;, total: {$sum: &quot;$amount&quot;}}，每一个管道表达式都是对象的形式，里面也包含了key和value，key通常都是字段名，value就是字段值， 字段值里面可以是由表达式操作符组成的对象，例如：{$sum: &quot;$amount&quot;}，这个对象就是由表达式操作符组成的，其中，$sum就是一个表达式操作符，用于求和运算</p> <p>常见的表达式操作符如下：</p> <table><thead><tr><th>表达式操作符</th> <th>功能描述</th></tr></thead> <tbody><tr><td>$addToSet</td> <td>将文档的指定字段的值去重</td></tr> <tr><td>$max</td> <td>求字段的最大值</td></tr> <tr><td>$min</td> <td>求字段的最小值</td></tr> <tr><td>$sum</td> <td>求和</td></tr> <tr><td>$avg</td> <td>求平均值</td></tr> <tr><td>$gt</td> <td>大于</td></tr> <tr><td>$lt</td> <td>小于</td></tr> <tr><td>$eq</td> <td>等于</td></tr></tbody></table> <h4 id="_4-实际操作"><a href="#_4-实际操作" aria-hidden="true" class="header-anchor">#</a> 4.实际操作</h4> <p>准备数据，你可以将下列代码直接拷贝到mongodb中执行：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;uid&quot;</span><span class="token punctuation">:</span><span class="token number">10001</span><span class="token punctuation">,</span><span class="token string">&quot;trade_no&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;nd001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;all_price&quot;</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">&quot;all_num&quot;</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;uid&quot;</span><span class="token punctuation">:</span><span class="token number">10002</span><span class="token punctuation">,</span><span class="token string">&quot;trade_no&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;nd002&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;all_price&quot;</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">&quot;all_num&quot;</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;uid&quot;</span><span class="token punctuation">:</span><span class="token number">10003</span><span class="token punctuation">,</span><span class="token string">&quot;trade_no&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;nd003&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;all_price&quot;</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string">&quot;all_num&quot;</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;无线鼠标 1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;无线键盘 2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">600</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;有线键盘 3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">700</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;苹果&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;香蕉&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">40</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;牛奶&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;order_id&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;面包&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>num<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/assets/img/2019-05-09-06-14-07.334cc12b.png" alt=""></p> <h5 id="_1-project"><a href="#_1-project" aria-hidden="true" class="header-anchor">#</a> 1.$project</h5> <p>通俗的说这个管道操作符可以用来筛选指定的字段</p> <p>举例：查询出订单信息，只显示订单号</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$project<span class="token punctuation">:</span><span class="token punctuation">{</span>_id<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> order_id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_2-match"><a href="#_2-match" aria-hidden="true" class="header-anchor">#</a> 2.$match</h5> <p>通俗的说$match操作的作用就是查找满足条件的数据</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$project<span class="token punctuation">:</span> <span class="token punctuation">{</span>order_id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> all_price<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>$match<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;all_price&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>$gt<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_3-group"><a href="#_3-group" aria-hidden="true" class="header-anchor">#</a> 3.$group</h5> <p>$group主要是用来进行分组操作的</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$group<span class="token punctuation">:</span> <span class="token punctuation">{</span>_id<span class="token punctuation">:</span> <span class="token string">&quot;$order_id&quot;</span><span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token punctuation">{</span>$sum<span class="token punctuation">:</span> <span class="token string">&quot;$num&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：在使用$group的时候必须有一个_id作为分组的条件</p> <h5 id="_4-sort"><a href="#_4-sort" aria-hidden="true" class="header-anchor">#</a> 4.$sort</h5> <p>$sort的作用是用来进行排序</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$sort<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>注意： -1 表示降序， 1表示升序</p> <h5 id="_5-limit"><a href="#_5-limit" aria-hidden="true" class="header-anchor">#</a> 5.$limit</h5> <p>$limit的作用是限制显示条数</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$sort<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>$limit<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_6-skip"><a href="#_6-skip" aria-hidden="true" class="header-anchor">#</a> 6.$skip</h5> <p>$skip的作用是可以跳过的条数</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order_item<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$sort<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>$skip<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_7-lookup"><a href="#_7-lookup" aria-hidden="true" class="header-anchor">#</a> 7.$lookup</h5> <p>$lookup用来做关联查询，举个例子：查询order表中，order_id对应的商品信息</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>order<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>$lookup<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">&quot;order_item&quot;</span><span class="token punctuation">,</span> localField<span class="token punctuation">:</span> <span class="token string">&quot;order_id&quot;</span><span class="token punctuation">,</span> foreignField<span class="token punctuation">:</span> <span class="token string">&quot;order_id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token punctuation">:</span> <span class="token string">&quot;order_detail&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/basics/mongodb快速入门教程/MongoDB的基本的CRUD操作.html" class="prev">
          2.MongoDB的基本的CRUD操作
        </a></span> <span class="next"><a href="/basics/mongodb快速入门教程/Mongoose使用.html">
          4.Mongoose使用
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c3c285e.js" defer></script><script src="/assets/js/2.35988976.js" defer></script><script src="/assets/js/16.ba17c819.js" defer></script>
  </body>
</html>
