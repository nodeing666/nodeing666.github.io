<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>4.Mongoose使用 | 螺钉前端</title>
    <meta name="description" content="帮助零基础同学转行，入职前端开发，薪资5000-12000">
    <link rel="icon" href="/logo.png">
  <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e2bd54b8015cec977c6f30d0896b8a1b";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
      </script>
    
    <link rel="preload" href="/assets/css/0.styles.830e21dc.css" as="style"><link rel="preload" href="/assets/js/app.4c3c285e.js" as="script"><link rel="preload" href="/assets/js/2.35988976.js" as="script"><link rel="preload" href="/assets/js/18.b20be58c.js" as="script"><link rel="prefetch" href="/assets/js/10.0809a72a.js"><link rel="prefetch" href="/assets/js/100.d8310b4b.js"><link rel="prefetch" href="/assets/js/101.503f02c3.js"><link rel="prefetch" href="/assets/js/102.5d351a2d.js"><link rel="prefetch" href="/assets/js/103.c6129a47.js"><link rel="prefetch" href="/assets/js/104.5ded5ac5.js"><link rel="prefetch" href="/assets/js/105.589fa0d4.js"><link rel="prefetch" href="/assets/js/106.a5d3f2d9.js"><link rel="prefetch" href="/assets/js/107.651f67d2.js"><link rel="prefetch" href="/assets/js/108.d0d9b2ce.js"><link rel="prefetch" href="/assets/js/109.1a94580a.js"><link rel="prefetch" href="/assets/js/11.117e5df8.js"><link rel="prefetch" href="/assets/js/110.5d026414.js"><link rel="prefetch" href="/assets/js/111.b9698895.js"><link rel="prefetch" href="/assets/js/112.2f1eee19.js"><link rel="prefetch" href="/assets/js/113.ab1cc016.js"><link rel="prefetch" href="/assets/js/114.bb666e12.js"><link rel="prefetch" href="/assets/js/115.792d9fcc.js"><link rel="prefetch" href="/assets/js/116.6c4b9e1a.js"><link rel="prefetch" href="/assets/js/117.0f22d149.js"><link rel="prefetch" href="/assets/js/118.e0cdb666.js"><link rel="prefetch" href="/assets/js/119.53a0c74f.js"><link rel="prefetch" href="/assets/js/12.44c347ff.js"><link rel="prefetch" href="/assets/js/120.d3bda3aa.js"><link rel="prefetch" href="/assets/js/121.2eac6dcb.js"><link rel="prefetch" href="/assets/js/122.0c22ef17.js"><link rel="prefetch" href="/assets/js/123.fb674a1e.js"><link rel="prefetch" href="/assets/js/124.c1957c66.js"><link rel="prefetch" href="/assets/js/125.82296d79.js"><link rel="prefetch" href="/assets/js/126.cad2ebcc.js"><link rel="prefetch" href="/assets/js/127.536fc158.js"><link rel="prefetch" href="/assets/js/128.f38a8121.js"><link rel="prefetch" href="/assets/js/129.835af9eb.js"><link rel="prefetch" href="/assets/js/13.0990c880.js"><link rel="prefetch" href="/assets/js/130.0e32ffff.js"><link rel="prefetch" href="/assets/js/131.06dc20fa.js"><link rel="prefetch" href="/assets/js/132.b3af08ce.js"><link rel="prefetch" href="/assets/js/133.d0d4d25d.js"><link rel="prefetch" href="/assets/js/134.7c659774.js"><link rel="prefetch" href="/assets/js/135.91d30218.js"><link rel="prefetch" href="/assets/js/136.705e71a1.js"><link rel="prefetch" href="/assets/js/137.67ac551a.js"><link rel="prefetch" href="/assets/js/138.e1f063e6.js"><link rel="prefetch" href="/assets/js/139.c64481f7.js"><link rel="prefetch" href="/assets/js/14.4d578419.js"><link rel="prefetch" href="/assets/js/140.b3a94175.js"><link rel="prefetch" href="/assets/js/141.b1881667.js"><link rel="prefetch" href="/assets/js/142.f60ac7ca.js"><link rel="prefetch" href="/assets/js/143.d2bf8c2b.js"><link rel="prefetch" href="/assets/js/144.28d0a4f2.js"><link rel="prefetch" href="/assets/js/145.2520fa3a.js"><link rel="prefetch" href="/assets/js/146.74de499d.js"><link rel="prefetch" href="/assets/js/147.f9128127.js"><link rel="prefetch" href="/assets/js/148.af3b2732.js"><link rel="prefetch" href="/assets/js/149.d82805ec.js"><link rel="prefetch" href="/assets/js/15.0aec8b55.js"><link rel="prefetch" href="/assets/js/150.25aeea37.js"><link rel="prefetch" href="/assets/js/151.abd7ef02.js"><link rel="prefetch" href="/assets/js/152.9144e36e.js"><link rel="prefetch" href="/assets/js/153.e161c356.js"><link rel="prefetch" href="/assets/js/154.d1f428f9.js"><link rel="prefetch" href="/assets/js/155.cfb64163.js"><link rel="prefetch" href="/assets/js/156.c1d7efea.js"><link rel="prefetch" href="/assets/js/157.7cc86938.js"><link rel="prefetch" href="/assets/js/158.0bbdbb57.js"><link rel="prefetch" href="/assets/js/159.6fb40b2e.js"><link rel="prefetch" href="/assets/js/16.ba17c819.js"><link rel="prefetch" href="/assets/js/160.a2704844.js"><link rel="prefetch" href="/assets/js/161.129a8d66.js"><link rel="prefetch" href="/assets/js/162.9fcbc103.js"><link rel="prefetch" href="/assets/js/163.bc8b2720.js"><link rel="prefetch" href="/assets/js/164.23718563.js"><link rel="prefetch" href="/assets/js/165.3832b2fb.js"><link rel="prefetch" href="/assets/js/166.50cdb4b6.js"><link rel="prefetch" href="/assets/js/167.3894de9c.js"><link rel="prefetch" href="/assets/js/168.31c105f6.js"><link rel="prefetch" href="/assets/js/169.ce5b3623.js"><link rel="prefetch" href="/assets/js/17.82672299.js"><link rel="prefetch" href="/assets/js/170.c1c272d8.js"><link rel="prefetch" href="/assets/js/171.28ae28fd.js"><link rel="prefetch" href="/assets/js/172.e88b63ba.js"><link rel="prefetch" href="/assets/js/173.d80be42c.js"><link rel="prefetch" href="/assets/js/174.c93d8ee6.js"><link rel="prefetch" href="/assets/js/175.5ad5c54a.js"><link rel="prefetch" href="/assets/js/176.9be9b361.js"><link rel="prefetch" href="/assets/js/177.1da98845.js"><link rel="prefetch" href="/assets/js/178.050b5a93.js"><link rel="prefetch" href="/assets/js/179.44f7d1b5.js"><link rel="prefetch" href="/assets/js/180.b5d4db3c.js"><link rel="prefetch" href="/assets/js/181.4a2a0ca9.js"><link rel="prefetch" href="/assets/js/182.07a102f3.js"><link rel="prefetch" href="/assets/js/183.cdcf0c40.js"><link rel="prefetch" href="/assets/js/184.4f78232c.js"><link rel="prefetch" href="/assets/js/185.f51bec5f.js"><link rel="prefetch" href="/assets/js/186.029f1d35.js"><link rel="prefetch" href="/assets/js/187.f255a676.js"><link rel="prefetch" href="/assets/js/188.de182007.js"><link rel="prefetch" href="/assets/js/189.10b972f3.js"><link rel="prefetch" href="/assets/js/19.b7271ed6.js"><link rel="prefetch" href="/assets/js/190.5fd9343d.js"><link rel="prefetch" href="/assets/js/191.f5152b31.js"><link rel="prefetch" href="/assets/js/192.66d7fa13.js"><link rel="prefetch" href="/assets/js/193.fdeaeda4.js"><link rel="prefetch" href="/assets/js/194.ad25ba5e.js"><link rel="prefetch" href="/assets/js/195.03913adc.js"><link rel="prefetch" href="/assets/js/196.d2ce6bf5.js"><link rel="prefetch" href="/assets/js/197.34acf369.js"><link rel="prefetch" href="/assets/js/198.a329ed4e.js"><link rel="prefetch" href="/assets/js/199.114b5c2b.js"><link rel="prefetch" href="/assets/js/20.ec886eea.js"><link rel="prefetch" href="/assets/js/200.91f58af4.js"><link rel="prefetch" href="/assets/js/201.8607f87f.js"><link rel="prefetch" href="/assets/js/202.1d1b5024.js"><link rel="prefetch" href="/assets/js/203.6332d6aa.js"><link rel="prefetch" href="/assets/js/204.144f7ce3.js"><link rel="prefetch" href="/assets/js/205.16a39432.js"><link rel="prefetch" href="/assets/js/206.6eac6d07.js"><link rel="prefetch" href="/assets/js/207.befb0534.js"><link rel="prefetch" href="/assets/js/208.82b906c6.js"><link rel="prefetch" href="/assets/js/209.8c8cce8f.js"><link rel="prefetch" href="/assets/js/21.f2a3e37a.js"><link rel="prefetch" href="/assets/js/210.6c38f127.js"><link rel="prefetch" href="/assets/js/211.3e7e3332.js"><link rel="prefetch" href="/assets/js/212.a9bc62eb.js"><link rel="prefetch" href="/assets/js/213.b5bce6ee.js"><link rel="prefetch" href="/assets/js/214.7a7e0c32.js"><link rel="prefetch" href="/assets/js/215.3363643e.js"><link rel="prefetch" href="/assets/js/216.576d4291.js"><link rel="prefetch" href="/assets/js/217.9b02761b.js"><link rel="prefetch" href="/assets/js/218.2c8d5026.js"><link rel="prefetch" href="/assets/js/219.0a093045.js"><link rel="prefetch" href="/assets/js/22.468bb897.js"><link rel="prefetch" href="/assets/js/220.25759ab0.js"><link rel="prefetch" href="/assets/js/221.45332d2d.js"><link rel="prefetch" href="/assets/js/222.d25f0cfa.js"><link rel="prefetch" href="/assets/js/223.0bfa2457.js"><link rel="prefetch" href="/assets/js/224.70b2953f.js"><link rel="prefetch" href="/assets/js/225.46da8954.js"><link rel="prefetch" href="/assets/js/226.097d15f7.js"><link rel="prefetch" href="/assets/js/227.10b91bea.js"><link rel="prefetch" href="/assets/js/228.5d586eb3.js"><link rel="prefetch" href="/assets/js/229.2a60964a.js"><link rel="prefetch" href="/assets/js/23.2b2fa42d.js"><link rel="prefetch" href="/assets/js/230.abcbb8ee.js"><link rel="prefetch" href="/assets/js/231.a314da07.js"><link rel="prefetch" href="/assets/js/232.64676258.js"><link rel="prefetch" href="/assets/js/233.9c86ded1.js"><link rel="prefetch" href="/assets/js/234.a18f20a6.js"><link rel="prefetch" href="/assets/js/235.3c6f087c.js"><link rel="prefetch" href="/assets/js/236.26e894d3.js"><link rel="prefetch" href="/assets/js/237.46d1f99f.js"><link rel="prefetch" href="/assets/js/238.46026479.js"><link rel="prefetch" href="/assets/js/239.ff830552.js"><link rel="prefetch" href="/assets/js/24.da8569e4.js"><link rel="prefetch" href="/assets/js/240.7ce2fbe0.js"><link rel="prefetch" href="/assets/js/241.7f63fcc0.js"><link rel="prefetch" href="/assets/js/242.8295f0de.js"><link rel="prefetch" href="/assets/js/243.f183b175.js"><link rel="prefetch" href="/assets/js/244.acc3278b.js"><link rel="prefetch" href="/assets/js/245.7ef73821.js"><link rel="prefetch" href="/assets/js/246.7ade592d.js"><link rel="prefetch" href="/assets/js/247.b6bdbc9e.js"><link rel="prefetch" href="/assets/js/248.397d3ae7.js"><link rel="prefetch" href="/assets/js/249.98b89913.js"><link rel="prefetch" href="/assets/js/25.44327d9b.js"><link rel="prefetch" href="/assets/js/250.108c519b.js"><link rel="prefetch" href="/assets/js/251.df25c95b.js"><link rel="prefetch" href="/assets/js/252.44d67967.js"><link rel="prefetch" href="/assets/js/253.c8c169a0.js"><link rel="prefetch" href="/assets/js/254.c6d1d240.js"><link rel="prefetch" href="/assets/js/255.3e875698.js"><link rel="prefetch" href="/assets/js/256.9608b951.js"><link rel="prefetch" href="/assets/js/257.5154d8b3.js"><link rel="prefetch" href="/assets/js/258.68c0084a.js"><link rel="prefetch" href="/assets/js/259.1e17eb83.js"><link rel="prefetch" href="/assets/js/26.8e3a2fdc.js"><link rel="prefetch" href="/assets/js/260.2bfb1254.js"><link rel="prefetch" href="/assets/js/261.305c4aba.js"><link rel="prefetch" href="/assets/js/262.f4e95dbe.js"><link rel="prefetch" href="/assets/js/263.958e0e0d.js"><link rel="prefetch" href="/assets/js/264.7baca583.js"><link rel="prefetch" href="/assets/js/265.cf5ee4ac.js"><link rel="prefetch" href="/assets/js/266.1c987332.js"><link rel="prefetch" href="/assets/js/267.10bf52cc.js"><link rel="prefetch" href="/assets/js/268.3b20da52.js"><link rel="prefetch" href="/assets/js/269.838c4103.js"><link rel="prefetch" href="/assets/js/27.01e54737.js"><link rel="prefetch" href="/assets/js/270.90dc1d21.js"><link rel="prefetch" href="/assets/js/271.293bf47a.js"><link rel="prefetch" href="/assets/js/272.ad955cce.js"><link rel="prefetch" href="/assets/js/273.20689a28.js"><link rel="prefetch" href="/assets/js/274.f1680a80.js"><link rel="prefetch" href="/assets/js/275.3aac1e18.js"><link rel="prefetch" href="/assets/js/276.4341cdcb.js"><link rel="prefetch" href="/assets/js/277.c1646afd.js"><link rel="prefetch" href="/assets/js/278.ffda642b.js"><link rel="prefetch" href="/assets/js/279.0712cfd5.js"><link rel="prefetch" href="/assets/js/28.4a3312b8.js"><link rel="prefetch" href="/assets/js/280.d0a9e837.js"><link rel="prefetch" href="/assets/js/281.7f94b988.js"><link rel="prefetch" href="/assets/js/29.7deca706.js"><link rel="prefetch" href="/assets/js/3.619aa9ab.js"><link rel="prefetch" href="/assets/js/30.bbe18c23.js"><link rel="prefetch" href="/assets/js/31.d9858940.js"><link rel="prefetch" href="/assets/js/32.b5337a99.js"><link rel="prefetch" href="/assets/js/33.743e0245.js"><link rel="prefetch" href="/assets/js/34.045bd74e.js"><link rel="prefetch" href="/assets/js/35.79ff5def.js"><link rel="prefetch" href="/assets/js/36.1a1400b4.js"><link rel="prefetch" href="/assets/js/37.66b0b9cc.js"><link rel="prefetch" href="/assets/js/38.1cbbe2a9.js"><link rel="prefetch" href="/assets/js/39.4b7cc766.js"><link rel="prefetch" href="/assets/js/4.72e92390.js"><link rel="prefetch" href="/assets/js/40.5e06f5bf.js"><link rel="prefetch" href="/assets/js/41.4e4631a8.js"><link rel="prefetch" href="/assets/js/42.880981c4.js"><link rel="prefetch" href="/assets/js/43.178e9db3.js"><link rel="prefetch" href="/assets/js/44.cb911db2.js"><link rel="prefetch" href="/assets/js/45.f46a1807.js"><link rel="prefetch" href="/assets/js/46.72d2caae.js"><link rel="prefetch" href="/assets/js/47.ec98d891.js"><link rel="prefetch" href="/assets/js/48.3e48a260.js"><link rel="prefetch" href="/assets/js/49.5b4acb74.js"><link rel="prefetch" href="/assets/js/5.60e38b16.js"><link rel="prefetch" href="/assets/js/50.87ebcffd.js"><link rel="prefetch" href="/assets/js/51.d0c481a1.js"><link rel="prefetch" href="/assets/js/52.ceeea1f7.js"><link rel="prefetch" href="/assets/js/53.aa7484c2.js"><link rel="prefetch" href="/assets/js/54.852fbdeb.js"><link rel="prefetch" href="/assets/js/55.71eed07f.js"><link rel="prefetch" href="/assets/js/56.d7b4184a.js"><link rel="prefetch" href="/assets/js/57.b855843f.js"><link rel="prefetch" href="/assets/js/58.99ea811e.js"><link rel="prefetch" href="/assets/js/59.c35d6ca0.js"><link rel="prefetch" href="/assets/js/6.e2a5f4eb.js"><link rel="prefetch" href="/assets/js/60.faa94541.js"><link rel="prefetch" href="/assets/js/61.201bd301.js"><link rel="prefetch" href="/assets/js/62.6b322f48.js"><link rel="prefetch" href="/assets/js/63.1d9e0c71.js"><link rel="prefetch" href="/assets/js/64.8da9224b.js"><link rel="prefetch" href="/assets/js/65.3b6af424.js"><link rel="prefetch" href="/assets/js/66.587fc6bc.js"><link rel="prefetch" href="/assets/js/67.29f1149e.js"><link rel="prefetch" href="/assets/js/68.c4b9a60c.js"><link rel="prefetch" href="/assets/js/69.32aee3ee.js"><link rel="prefetch" href="/assets/js/7.016407d6.js"><link rel="prefetch" href="/assets/js/70.9a8a0683.js"><link rel="prefetch" href="/assets/js/71.b8e3cdc6.js"><link rel="prefetch" href="/assets/js/72.f0fc170f.js"><link rel="prefetch" href="/assets/js/73.7d91c309.js"><link rel="prefetch" href="/assets/js/74.b5f0255a.js"><link rel="prefetch" href="/assets/js/75.e86f9491.js"><link rel="prefetch" href="/assets/js/76.033a8716.js"><link rel="prefetch" href="/assets/js/77.a4e3262b.js"><link rel="prefetch" href="/assets/js/78.e2ea8d44.js"><link rel="prefetch" href="/assets/js/79.72045e29.js"><link rel="prefetch" href="/assets/js/8.4428ceee.js"><link rel="prefetch" href="/assets/js/80.2dfbf868.js"><link rel="prefetch" href="/assets/js/81.a35fea2c.js"><link rel="prefetch" href="/assets/js/82.cac44de7.js"><link rel="prefetch" href="/assets/js/83.b1e15f71.js"><link rel="prefetch" href="/assets/js/84.744feca7.js"><link rel="prefetch" href="/assets/js/85.d4398600.js"><link rel="prefetch" href="/assets/js/86.2ff5fc32.js"><link rel="prefetch" href="/assets/js/87.2b2547de.js"><link rel="prefetch" href="/assets/js/88.8807bdd7.js"><link rel="prefetch" href="/assets/js/89.bf869c9a.js"><link rel="prefetch" href="/assets/js/9.f56957fc.js"><link rel="prefetch" href="/assets/js/90.4105c2f5.js"><link rel="prefetch" href="/assets/js/91.24a33f7f.js"><link rel="prefetch" href="/assets/js/92.8d7dbaad.js"><link rel="prefetch" href="/assets/js/93.9e6fd924.js"><link rel="prefetch" href="/assets/js/94.9381c401.js"><link rel="prefetch" href="/assets/js/95.eaa1808d.js"><link rel="prefetch" href="/assets/js/96.e3a8d59f.js"><link rel="prefetch" href="/assets/js/97.a6375129.js"><link rel="prefetch" href="/assets/js/98.ad841694.js"><link rel="prefetch" href="/assets/js/99.3a6761fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.830e21dc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">螺钉前端</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/basics/" class="nav-link router-link-active">基础教程</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目实战</a></div><div class="nav-item"><a href="/article/" class="nav-link">零散文章</a></div><div class="nav-item"><a href="/association/" class="nav-link">一起学习</a></div><div class="nav-item"><a href="/architect/" class="nav-link">前端架构师</a></div><div class="nav-item"><a href="/article/螺钉课堂产品矩阵/" class="nav-link">螺钉课堂产品矩阵</a></div><div class="nav-item"><a href="https://edu.nodeing.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/basics/" class="nav-link router-link-active">基础教程</a></div><div class="nav-item"><a href="/project/" class="nav-link">项目实战</a></div><div class="nav-item"><a href="/article/" class="nav-link">零散文章</a></div><div class="nav-item"><a href="/association/" class="nav-link">一起学习</a></div><div class="nav-item"><a href="/architect/" class="nav-link">前端架构师</a></div><div class="nav-item"><a href="/article/螺钉课堂产品矩阵/" class="nav-link">螺钉课堂产品矩阵</a></div><div class="nav-item"><a href="https://edu.nodeing.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频学习
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/basics/mongodb%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="sidebar-link">MongoDB快速入门教程</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB初识.html" class="sidebar-link">1.MongoDB初识</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB的基本的CRUD操作.html" class="sidebar-link">2.MongoDB的基本的CRUD操作</a></li><li><a href="/basics/mongodb快速入门教程/MongoDB进阶.html" class="sidebar-link">3.MongoDB进阶</a></li><li><a href="/basics/mongodb快速入门教程/Mongoose使用.html" class="active sidebar-link">4.Mongoose使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-1-nodejs操作mongodb" class="sidebar-link">4.1.nodejs操作mongodb</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-2-mongoose实现增删查改" class="sidebar-link">4.2.Mongoose实现增删查改</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-3-mongoose模块化" class="sidebar-link">4.3.Mongoose模块化</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-4-mongoose预处理保存的数据" class="sidebar-link">4.4.Mongoose预处理保存的数据</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-5-mongoose索引和方法" class="sidebar-link">4.5.Mongoose索引和方法</a></li><li class="sidebar-sub-header"><a href="/basics/mongodb快速入门教程/Mongoose使用.html#_4-6-mongoose数据校验" class="sidebar-link">4.6.Mongoose数据校验</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_4-mongoose使用"><a href="#_4-mongoose使用" aria-hidden="true" class="header-anchor">#</a> 4.Mongoose使用</h1> <h2 id="_4-1-nodejs操作mongodb"><a href="#_4-1-nodejs操作mongodb" aria-hidden="true" class="header-anchor">#</a> 4.1.nodejs操作mongodb</h2> <p>文档地址：<a href="http://mongodb.github.io/node-mongodb-native/3.2/tutorials/crud/" target="_blank" rel="noopener noreferrer">http://mongodb.github.io/node-mongodb-native/3.2/tutorials/crud/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>1.安装mongodb驱动</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install mongodb <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>2.连接数据库</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">var</span> dburl <span class="token operator">=</span> <span class="token string">&quot;mongodb://admin:123456@127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>
MongoClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>dburl<span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>client</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>3.插入数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;mongodb://admin:123456@127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>client</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// 插入数据</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;nodeing&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>4.更新数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;mongodb://admin:123456@127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>client</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;nodeing&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>$<span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">38</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>5.删除数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;mongodb://admin:123456@127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>client</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;nodeing&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_4-2-mongoose实现增删查改"><a href="#_4-2-mongoose实现增删查改" aria-hidden="true" class="header-anchor">#</a> 4.2.Mongoose实现增删查改</h2> <p>中文文档地址： <a href="https://cn.mongoosedoc.top/docs/guide.html" target="_blank" rel="noopener noreferrer">https://cn.mongoosedoc.top/docs/guide.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_4-2-1-mongoose是什么？"><a href="#_4-2-1-mongoose是什么？" aria-hidden="true" class="header-anchor">#</a> 4.2.1.Mongoose是什么？</h3> <p>Mongoose是MongoDB的一个对象模型工具，封装了MongoDB对文档的的一些增删改查等常用方法，让NodeJS操作Mongodb数据库变得更加灵活简单，换句话说就是Mongoose是一个工具，这个工具可以让nodejs操作MongoDB更加方便</p> <p>在学习之前我们需要注意Mongoose的一个特点，那就是通过关系型数据库的思想来设计非关系型数据库</p> <h3 id="_4-2-2-准备工作"><a href="#_4-2-2-准备工作" aria-hidden="true" class="header-anchor">#</a> 4.2.2.准备工作</h3> <p>1.安装mongoose</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install mongoose <span class="token operator">--</span>save
</code></pre></div><p>2.连接数据库</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>3.定义Schema</p> <p>什么是Schema呢？Schema是mongoose里用到的一种数据模式，可以理解为表结构的定义，举个例子：当我们使用关系型数据库MySQL的时候，我们需要先确定数据库字段，每个字段的类型、是否为空、默认值等等，Schema的定义就是起类似的作用，比如，我需要给user这个文档定义Schema</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>上面就规定了user文档中存的name值必须为字符串类型，age必须为数字类型</p> <p>下面是支持的类型：</p> <div class="language-js extra-class"><pre class="language-js"><code>String      字符串
Number      数字    
Date        日期
Buffer      二进制
Boolean     布尔值
Mixed       混合类型
ObjectId    对象<span class="token constant">ID</span>    
Array       数组
</code></pre></div><p>完整步骤代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3.定义Schema，例如：现在需要操作users集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_4-2-3-增删查改操作"><a href="#_4-2-3-增删查改操作" aria-hidden="true" class="header-anchor">#</a> 4.2.3.增删查改操作</h3> <p>前面我们定义的Schema只是约定了一种数据模式，并不具备操作数据库的能力，如果想要操作数据库，还需要定义模型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>
</code></pre></div><p>通过上面的代码，我们创建出了一个User模型，这个User 模型才具有操作User集合(表)的能力</p> <p>定义模型注意事项：1、model里面第一个参数的命名要首字母大写  2、这个模型的名字要和数据库中集合(表)的名字对应，默认的对应规则为：如果模型名字最后一位是字母，那么对应数据库中的名字会加s，例如：模型名字为User，那么对应的数据库中的集合名字为users，如果模型名字最后一个是数字，那么和数据库中的集合名字不用加s，例如：模型名字为User1，对应的数据库中的集合名字为user1  3、可以指定模型名称关联的集合，需要写成下面这样</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 指定User模型 对应数据库中user集合</span>
<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_1-增加数据"><a href="#_1-增加数据" aria-hidden="true" class="header-anchor">#</a> 1.增加数据</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>

<span class="token comment">// 5.增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="_2-查询数据"><a href="#_2-查询数据" aria-hidden="true" class="header-anchor">#</a> 2.查询数据</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>

<span class="token comment">// // 5.增加数据</span>
<span class="token comment">// let UserObj = new User({</span>
<span class="token comment">//   name: '张三',</span>
<span class="token comment">//   age: 20,</span>
<span class="token comment">//   status: 0</span>
<span class="token comment">// })</span>
<span class="token comment">// UserObj.save()</span>

<span class="token comment">// 6.查询数据</span>

<span class="token comment">// User.find({}, (err, result) =&gt; {</span>
<span class="token comment">//   if (err) {</span>
<span class="token comment">//     console.log(err)</span>
<span class="token comment">//     return</span>
<span class="token comment">//   }</span>
<span class="token comment">//   console.log(result)</span>
<span class="token comment">// })</span>

</code></pre></div><h4 id="_3-更新数据"><a href="#_3-更新数据" aria-hidden="true" class="header-anchor">#</a> 3.更新数据</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>

<span class="token comment">// // 5.增加数据</span>
<span class="token comment">// let UserObj = new User({</span>
<span class="token comment">//   name: '张三',</span>
<span class="token comment">//   age: 20,</span>
<span class="token comment">//   status: 0</span>
<span class="token comment">// })</span>
<span class="token comment">// UserObj.save()</span>

<span class="token comment">// 6.查询数据</span>

<span class="token comment">// User.find({}, (err, result) =&gt; {</span>
<span class="token comment">//   if (err) {</span>
<span class="token comment">//     console.log(err)</span>
<span class="token comment">//     return</span>
<span class="token comment">//   }</span>
<span class="token comment">//   console.log(result)</span>
<span class="token comment">// })</span>

<span class="token comment">// 7.修改数据</span>

User<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>age<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;更新成功&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="_4-删除数据"><a href="#_4-删除数据" aria-hidden="true" class="header-anchor">#</a> 4.删除数据</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>

<span class="token comment">// // 5.增加数据</span>
<span class="token comment">// let UserObj = new User({</span>
<span class="token comment">//   name: '张三',</span>
<span class="token comment">//   age: 20,</span>
<span class="token comment">//   status: 0</span>
<span class="token comment">// })</span>
<span class="token comment">// UserObj.save()</span>

<span class="token comment">// 6.查询数据</span>

<span class="token comment">// User.find({}, (err, result) =&gt; {</span>
<span class="token comment">//   if (err) {</span>
<span class="token comment">//     console.log(err)</span>
<span class="token comment">//     return</span>
<span class="token comment">//   }</span>
<span class="token comment">//   console.log(result)</span>
<span class="token comment">// })</span>

<span class="token comment">// 7.修改数据</span>

<span class="token comment">// User.updateOne({name: &quot;张三&quot;}, {age: 42}, (err, result) =&gt; {</span>
<span class="token comment">//   if (err) {</span>
<span class="token comment">//     console.log(err)</span>
<span class="token comment">//     return</span>
<span class="token comment">//   }</span>
<span class="token comment">//   console.log(&quot;更新成功&quot;)</span>
<span class="token comment">// })</span>

<span class="token comment">// 8.删除数据</span>
User<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'张三'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="_5-定义schema的时候可以给默认值"><a href="#_5-定义schema的时候可以给默认值" aria-hidden="true" class="header-anchor">#</a> 5.定义Schema的时候可以给默认值</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-3-mongoose模块化"><a href="#_4-3-mongoose模块化" aria-hidden="true" class="header-anchor">#</a> 4.3.Mongoose模块化</h2> <h3 id="_4-3-1-为什么要进行模块化拆分？"><a href="#_4-3-1-为什么要进行模块化拆分？" aria-hidden="true" class="header-anchor">#</a> 4.3.1.为什么要进行模块化拆分？</h3> <p>模块化拆分的目的是为了代码的复用，让整个项目的结构更加清晰，举个例子：当数据库中的集合变多的时候，例如有课程、订单、分类、教师等多个集合，我们将每个集合的代码拆分到不同的模块，这样项目结构会清晰很多，同时，这些模块都要连接数据库，每个模块都去连接一遍数据库显然是不合理的写法，正确的做法是把连接数据库的代码单独拆分出来，供各个模块连接数据库的时候使用</p> <h3 id="_4-3-2-拆分步骤"><a href="#_4-3-2-拆分步骤" aria-hidden="true" class="header-anchor">#</a> 4.3.2.拆分步骤</h3> <h4 id="_1-把数据库连接代码拆分出去"><a href="#_1-把数据库连接代码拆分出去" aria-hidden="true" class="header-anchor">#</a> 1.把数据库连接代码拆分出去</h4> <p>在项目目录下新建model目录，在model目录下新建db.js文件，这个文件用于存放数据库连接代码</p> <p>model/db.js代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.引入mongoose</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// 2.连接数据库</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose
</code></pre></div><h4 id="_2-把schema的定义和模型的创建拆分出去"><a href="#_2-把schema的定义和模型的创建拆分出去" aria-hidden="true" class="header-anchor">#</a> 2.把Schema的定义和模型的创建拆分出去</h4> <p>model/users.js中的代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span>
<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> User
</code></pre></div><h4 id="_3-在需要的地方使用上面拆除去的模块"><a href="#_3-在需要的地方使用上面拆除去的模块" aria-hidden="true" class="header-anchor">#</a> 3.在需要的地方使用上面拆除去的模块</h4> <p>新建一个app.js来测试是否可用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserModel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./model/users'</span><span class="token punctuation">)</span>

<span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>项目结构图：</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="_4-4-mongoose预处理保存的数据"><a href="#_4-4-mongoose预处理保存的数据" aria-hidden="true" class="header-anchor">#</a> 4.4.Mongoose预处理保存的数据</h2> <p>在定义Schema的时候，可以带上一些预定义的处理器，可以帮助我们处理需要保存到数据库的数据</p> <h3 id="_4-4-1-lowercase"><a href="#_4-4-1-lowercase" aria-hidden="true" class="header-anchor">#</a> 4.4.1.lowercase</h3> <p>定义Schema的时候带上lowercase，可以把需要保存的数据转成小写</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    lowercase<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>下面例子中name字段的值为全大写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'NONDEING'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>因为使用了lowercase，所以保存到数据库中的数据是经过处理了的：</p> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="_4-4-2-uppercase"><a href="#_4-4-2-uppercase" aria-hidden="true" class="header-anchor">#</a> 4.4.2.uppercase</h3> <p>uppercase是将字段值转成大写，这个和lowercase类似</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    uppercase<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>保存数据的时候，name值全为小写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'nodeing'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>保存到数据库后，被转成了大写：</p> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="_4-4-3-trim"><a href="#_4-4-3-trim" aria-hidden="true" class="header-anchor">#</a> 4.4.3.trim</h3> <p>trim的作用是去除两边的空格</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    uppercase<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>保存的数据如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'nodeing'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token string">&quot;   女   &quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>保存到数据库后的结果如下：</p> <p><img src="/assets/img/2019-05-24-16-00-23.7104504d.png" alt=""></p> <p>更多预处理器可以查看文档：<a href="https://cn.mongoosedoc.top/docs/schematypes.html" target="_blank" rel="noopener noreferrer">https://cn.mongoosedoc.top/docs/schematypes.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_4-4-4-自定义处理器"><a href="#_4-4-4-自定义处理器" aria-hidden="true" class="header-anchor">#</a> 4.4.4.自定义处理器</h3> <p>如果mongoose提供的预处理器没办法满足你的需求，你也可以自定义预处理器，举个例子：保存url的时候，我们规定必须保存http协议，这个时候就需要自定义一个预处理器去满足需求</p> <p>需求详解：</p> <div class="language-js extra-class"><pre class="language-js"><code>当保存这样的数据： www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com  我们希望处理后的结果为：http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com
</code></pre></div><p>定义Schema的时候，代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    uppercase<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'https://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>params
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>保存的数据如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'nodeing'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token string">&quot;   女   &quot;</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token string">&quot;www.baidu.com&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>处理后的数据如下：</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="_4-5-mongoose索引和方法"><a href="#_4-5-mongoose索引和方法" aria-hidden="true" class="header-anchor">#</a> 4.5.Mongoose索引和方法</h2> <h3 id="_4-5-1-设置索引"><a href="#_4-5-1-设置索引" aria-hidden="true" class="header-anchor">#</a> 4.5.1.设置索引</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
    <span class="token comment">// 设置唯一索引</span>
    unique<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token comment">// 设置普通索引</span>
    index<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'https://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>params
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：如果控制台出现下面的警告</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>解决方案：</p> <p>在连接数据库的时候加上配置项</p> <div class="language-js extra-class"><pre class="language-js"><code>mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://testadmin:nodeing123@127.0.0.1:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 使用createIndexes来创建索引</span>
  useCreateIndex<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_4-5-2-内置方法"><a href="#_4-5-2-内置方法" aria-hidden="true" class="header-anchor">#</a> 4.5.2.内置方法</h3> <p>文档地址：<a href="https://mongoosejs.com/docs/queries.html" target="_blank" rel="noopener noreferrer">https://mongoosejs.com/docs/queries.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>这些内置的方法我们其实已经在前面增删查改中使用过一些，这里不再举例</p> <h3 id="_4-5-3-扩展静态方法"><a href="#_4-5-3-扩展静态方法" aria-hidden="true" class="header-anchor">#</a> 4.5.3.扩展静态方法</h3> <p>静态方法的特点是不需要实例化就可以直接调用的</p> <p>1.在Schema上定义方法</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span>
<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
    <span class="token comment">// 设置唯一索引</span>
    unique<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    index<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token comment">// 设置普通索引</span>
    index<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">'男'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'https://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>params
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span><span class="token function-variable function">findBySn</span> <span class="token operator">=</span>  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sn<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;sn&quot;</span><span class="token punctuation">:</span> sn<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>



module<span class="token punctuation">.</span>exports <span class="token operator">=</span> User

</code></pre></div><p>2.调用方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserModel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./model/users'</span><span class="token punctuation">)</span>
UserModel<span class="token punctuation">.</span><span class="token function">findBySn</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-6-mongoose数据校验"><a href="#_4-6-mongoose数据校验" aria-hidden="true" class="header-anchor">#</a> 4.6.Mongoose数据校验</h2> <p>做数据校验的目的就是保证添加到数据库中的数据的合法性</p> <h3 id="_4-6-1-内置校验参数"><a href="#_4-6-1-内置校验参数" aria-hidden="true" class="header-anchor">#</a> 4.6.1.内置校验参数</h3> <p>以下是用于数据校验的各种参数</p> <table><thead><tr><th>参数</th> <th>作用</th></tr></thead> <tbody><tr><td>required</td> <td>这个数据必须传，不可以省</td></tr> <tr><td>max</td> <td>用于Number、日期类型，表示最大值</td></tr> <tr><td>min</td> <td>用于Number、日期类型，表示最小值</td></tr> <tr><td>enum</td> <td>枚举类型，要求数据必须满足枚举值</td></tr> <tr><td>match</td> <td>正则匹配</td></tr></tbody></table> <p>举个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
    max<span class="token punctuation">:</span> <span class="token number">1002</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'https://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>params
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>增加数据：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserModel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./model/users'</span><span class="token punctuation">)</span>

<span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token number">1001</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token string">'nodeing'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token string">&quot;www.baidu.com&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：上面增加数据的时候，gender没有传，但是定义Schema的时候，又加了required参数，那么就会报下面的错误</p> <p><img src="/assets/img/2019-05-24-18-39-18.e86a7260.png" alt=""></p> <p>从上面的例子我们可以看出，这些校验参数的作用实际上就是在规定数据的合法性的，不符合的数据不能存入数据库</p> <h3 id="_4-6-2-自定义验证器"><a href="#_4-6-2-自定义验证器" aria-hidden="true" class="header-anchor">#</a> 4.6.2.自定义验证器</h3> <p>自定义验证器是通过配置validate参数实现的，请注意看下面代码中的sn</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./db'</span><span class="token punctuation">)</span>
<span class="token comment">// 3.定义Schema，例如：现在需要操作user集合(表)，我们就需要给这个集合定义一个对应的Schema</span>

<span class="token keyword">let</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token function-variable function">validate</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">sn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 返回true表示验证通过 返回false表示验证失败</span>
      <span class="token keyword">return</span> sn<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'http://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> params<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'https://'</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;http://&quot;</span><span class="token operator">+</span>params
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 4.创建模型</span>

<span class="token keyword">let</span> User <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> UserSchema<span class="token punctuation">)</span>



module<span class="token punctuation">.</span>exports <span class="token operator">=</span> User
</code></pre></div><p>增加数据如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> UserModel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./model/users'</span><span class="token punctuation">)</span>

<span class="token comment">// 增加数据</span>
<span class="token keyword">let</span> UserObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  sn<span class="token punctuation">:</span> <span class="token string">&quot;1001&quot;</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token string">'nodeing'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
  status<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  gender<span class="token punctuation">:</span> <span class="token string">'男'</span><span class="token punctuation">,</span>
  pic<span class="token punctuation">:</span> <span class="token string">&quot;www.baidu.com&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
UserObj<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>注意：由于自定义验证器需要sn的长度大于5，增加的数据中sn只有4位，因此，会报如下错误：</p> <p><img src="/assets/img/2019-05-24-18-49-04.8c0ff731.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/basics/mongodb快速入门教程/MongoDB进阶.html" class="prev">
          3.MongoDB进阶
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c3c285e.js" defer></script><script src="/assets/js/2.35988976.js" defer></script><script src="/assets/js/18.b20be58c.js" defer></script>
  </body>
</html>
